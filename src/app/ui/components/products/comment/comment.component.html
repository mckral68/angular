<section class="bg-light" id="comments">
  <div class="container p-0">
    <div class="row py-4">
      <div class="col-lg-8">
        <div class="card mb-4">
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <a (click)="redirectTo()"
                ><i class="fa-solid fa-chevron-left" style="font-size: 20px"></i
              ></a>
              <h5 class="card-title fw-normal">Ürün Değerlendirmeleri</h5>
              <span></span>
            </div>
            <div *ngFor="let c of comment">
              <div>
                <div id="content">
                  <div class="rating-wrap">
                    <ng-template #t let-fill="fill">
                      <i class="bi bi-star-fill">
                        <i
                          *ngIf="fill > 0"
                          class="bi bi-star-fill filled"
                          [style.width.%]="fill"
                        ></i>
                      </i>
                    </ng-template>
                    <ngb-rating
                      [(rate)]="c.rankScore"
                      [starTemplate]="t"
                      [readonly]="true"
                      [max]="5"
                    ></ngb-rating>
                  </div>
                  <span class="text-success fs-6 mx-3">
                    Ürünü satın aldı
                    <i
                      class="fa-solid fa-circle-check"
                      style="color: #0bc15c"
                    ></i
                  ></span>
                </div>
                <div>
                  <span class="text-muted"
                    >{{ c?.firstName }} {{ c?.lastName }} |
                    {{ c.createdDate | date : "d/MM/yyyy H:mm" }}</span
                  >
                </div>
                <div class="mt-3 d-flex justify-content-between">
                  <p>
                    {{ c?.content }}
                  </p>
                </div>
                <div class="">
                  <div class="float-start">
                    <span>Beden</span>
                  </div>
                  <div class="d-flex float-end">
                    <div class="btn-group">
                      <button
                        class="btn btn-light btn-sm"
                        data-bs-toggle="tooltip"
                        data-bs-title="Like"
                        data-bs-original-title="comment"
                      >
                        <i class="fa fa-thumbs-up"></i>
                        <span class="text-muted ms-1">{{ c?.likeCount }}</span>
                      </button>
                      <button
                        class="btn btn-light btn-sm"
                        data-bs-toggle="tooltip"
                        data-bs-title="Dislike"
                        data-bs-original-title=""
                        title=""
                      >
                        <i class="fa fa-thumbs-down"></i>
                        <span class="text-muted ms-1">{{
                          c?.dislikeCount
                        }}</span>
                      </button>
                    </div>
                    <button class="btn btn-light btn-sm">
                      <i class="fa fa-ellipsis-v"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title text-center">Genel Değerlendirme</h5>
            <div class="d-flex justify-content-center align-items-center">
              <div class="rating-wrap pe-2">
                <ng-template #d let-fill="fill">
                  <i class="bi bi-star-fill" style="font-size: 1.4rem">
                    <i
                      *ngIf="fill > 0"
                      style="font-size: 1.4rem"
                      class="bi bi-star-fill filled"
                      [style.width.%]="fill"
                    ></i>
                  </i>
                </ng-template>
                <ngb-rating
                  [(rate)]="avgScore"
                  [starTemplate]="d"
                  [readonly]="true"
                  [max]="5"
                ></ngb-rating>
              </div>
              <p class="text-dark text-center mb-0 fw-bold">{{ avgScore }}</p>
            </div>
            <p class="text-center" style="font-size: 14px">
              {{ comment?.length }} Değerlendirme
            </p>
            <table class="table table-borderless table-sm">
              <tbody>
                <tr
                  style="vertical-align: middle"
                  *ngFor="let item of [].constructor(5); let i = index"
                >
                  <td style="width: 60px">
                    <i class="bi-star-fill filled"></i>
                    {{ 5 - i }}
                  </td>
                  <td>
                    <div
                      class="progress"
                      role="progressbar"
                      aria-label="Basic example"
                      aria-valuenow="0"
                      aria-valuemin="0"
                      aria-valuemax="100"
                    >
                      <div
                        class="progress-bar bg-warning"
                        [style.width.%]="(count[5 - i] / comment?.length) * 100"
                      ></div>
                    </div>
                  </td>
                  <td style="width: 50px" *ngIf="count[5 - i]">
                    <span class="text-muted">{{ count[5 - i] }}</span>
                  </td>
                  <td style="width: 50px" *ngIf="!count[5 - i]">
                    <span class="text-muted">0</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
